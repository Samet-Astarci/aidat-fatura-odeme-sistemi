<!doctype html>
<html lang="tr">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>GiriÅŸ â€¢ Site Aidat Takip</title>
  <link rel="stylesheet" href="/assets/app.css" />
</head>
<body>
  <div class="container">
    <div id="nav"></div>

    <div class="grid">
      <div class="card" style="grid-column: span 12;">
        <div class="hd"><h2>GiriÅŸ Yap ğŸ”</h2><span class="badge warn">Prototip</span></div>
        <div class="bd two-col">
          <div>
            <div class="row">
              <div>
                <label>Telefon</label>
                <input id="phone" placeholder="0555..." />
              </div>
              <div>
                <label>Åifre</label>
                <input id="password" type="password" placeholder="â€¢â€¢â€¢â€¢â€¢â€¢" />
              </div>
            </div>
            <div class="row" style="margin-top:12px;">
              <button id="btnLogin">GiriÅŸ</button>
              <button id="btnFillAdmin" class="btn-ghost">Admin Doldur</button>
              <button id="btnFillResident" class="btn-ghost">Sakin Doldur</button>
            </div>
            <div class="footer-note">
              Demo hesaplar README'de ğŸ¯
            </div>
          </div>

          <div>
            <div class="card" style="margin:0;">
              <div class="hd"><h2>Ne var burada? ğŸ‘€</h2></div>
              <div class="bd">
                <ul style="margin:0; padding-left:18px; color:var(--muted);">
                  <li>YÃ¶netici: daire & kullanÄ±cÄ± yÃ¶netimi</li>
                  <li>Toplu aidat tanÄ±mlama (dÃ¶nem + tutar)</li>
                  <li>Sakin: bakiye gÃ¶rÃ¼ntÃ¼leme + Ã¶deme (banka doÄŸrulama)</li>
                  <li>Gider/duyuru gÃ¶rÃ¼ntÃ¼leme</li>
                  <li>Finansal rapor (toplanan, gider, net)</li>
                </ul>
              </div>
            </div>
          </div>
        </div>
      </div>

      <div class="card">
        <div class="hd"><h2>BoÅŸ/Hata DurumlarÄ± âœ…</h2></div>
        <div class="bd" style="color:var(--muted);">
          <div>â€¢ Telefon/ÅŸifre boÅŸsa uyarÄ± verir</div>
          <div>â€¢ HatalÄ± ÅŸifre â†’ giriÅŸ reddedilir</div>
          <div>â€¢ Kart numarasÄ± hatalÄ± (Luhn) â†’ banka doÄŸrulamasÄ± baÅŸarÄ±sÄ±z</div>
          <div>â€¢ Ã–deme tutarÄ± borÃ§la aynÄ± deÄŸilse iÅŸlem durur</div>
        </div>
      </div>
    </div>
  </div>

  <script type="module">
    import { api, qs, setToken, setUser } from "/assets/common.js";
    import { mountNav, toast } from "/assets/ui.js";

    mountNav();

    const phone = qs("#phone");
    const password = qs("#password");

    qs("#btnFillAdmin").addEventListener("click", ()=>{ phone.value="05550000000"; password.value="admin123"; });
    qs("#btnFillResident").addEventListener("click", ()=>{ phone.value="05551112233"; password.value="123456"; });

    qs("#btnLogin").addEventListener("click", async ()=>{
      try{
        const data = await api("/api/auth/login", {
          method:"POST",
          body: JSON.stringify({ phone: phone.value.trim(), password: password.value })
        });
        setToken(data.token);
        setUser(data.user);

        if (data.user.role === "admin") location.href = "/admin/index.html";
        else location.href = "/resident/index.html";
      }catch(e){
        toast("GiriÅŸ baÅŸarÄ±sÄ±z âŒ", e.message);
      }
    });
  </script>
</body>
</html>